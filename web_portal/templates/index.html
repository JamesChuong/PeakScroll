<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PeakScroll</title>
    <style>
body {
    width: 100vw;
    height: 100vh;
    background-color: #101010;
    margin: 0;
    padding: 0;
}
video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    z-index: 0;
    margin: 0;
}
p {
    position: absolute;
    top: 8px;
    width: 100%;
    text-align: center;
    z-index: 99;
    color: white;
    font-family: sans-serif;
    font-size: 20pt;
    background-color: #10101060;
}
    </style>
</head>
<body>

      <p id="summary"></p>
      <video id="video" autoplay></video>

      <script>
            const video = document.getElementById("video");
            const summaryDisplay = document.getElementById("summary");

            // Access webcam
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => { video.srcObject = stream; });

            // Capture and send frame every 2s
            setInterval(() => {
                let canvas = document.createElement("canvas");
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                let ctx = canvas.getContext("2d");
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                canvas.toBlob(blob => {
                    let formData = new FormData();
                    formData.append("frame", blob, "frame.jpg");

                    fetch("/analyze_emotion", {
                        method: "POST",
                        body: formData
                    })
                    .then(res => res.json())
                    .then(data => {
                        summaryDisplay.innerText = "Emotion: " + data.emotion + ", Gesture: " + data.gesture;
                    });
                }, "image/jpeg");
            }, 500);
      </script>

</body>
</html>